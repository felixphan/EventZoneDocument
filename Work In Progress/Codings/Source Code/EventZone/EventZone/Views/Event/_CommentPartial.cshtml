@model EventZone.Models.CommentViewModel
@using EventZone.Models
@using EventZone.Helpers
@{
    ViewBag.Title = "_CommentPartial";
    User user = UserHelpers.GetCurrentUser(Session) ;
}
<div role="tabpanel" class="tab-pane active" id="i_comment">
    <div class="container-fluid d_cmt_content_cover">
        @if (Model.listComment != null && Model.listComment.Count != 0)
        {
            foreach (var item in Model.listComment)
            {
                @Html.ActionLink(item.User.UserName, "Detail", "User", new { id = @item.UserID }, null) <span>: @item.CommentContent</span>
                <br>
            }
        }
        
    </div>
    <div class="form-group d_write_comment">
        <textarea id="i_cmt_box"
                  class="form-control col-md-10" rows="1" 
                  placeholder="Write your comment..."></textarea>
        <button type="button" class="btn btn-success col-md-2" id="i_send_btn">
            <span class="glyphicon glyphicon-send"></span>
        </button>
    </div>
  
</div>

<script type="text/javascript" src="~/Scripts/jquery-1.11.3.min.js"></script>
<script>
    $(document).ready(function () {
        $("#i_send_btn").click(function () {
            @if (user == null) {
            <text>
            alert('Require Signin :((');
            </text>
           }
           else {
                <text>
            if (false) {
                alert('Please enter your comment' + $('#i_cmt_box').val());
            } else {
                $.ajax({
                    type: "post",
                    url: "/Event/Comment",
                    dataType: 'html',
                    cache: false,
                    data: { eventID: parseInt('@Model.eventID'), commentContent: $("#i_cmt_box").val() },
                    success: function (data) {
                        $("#comment-content").html("");
                        $("#comment-content").append(data);
                    },
                    error: function () {
                        alert('Error while request..');
                    }
                })
            }
            </text>
           }
        });
    })

</script>
